# ProxyNode2

**ProxyNode** — клиентская часть системы проксирования запросов, работающая совместно с **ProxyHub**.  
Позволяет перенаправлять API-запросы через центральный сервер (**ProxyHub**) на узлы, доступные только во внутренней сети клиента.

---

## Архитектура

Система состоит из двух компонентов:

- **ProxyHub** — центральный сервер, разворачивается в единственном экземпляре.
- **ProxyNode** — клиентский агент, запускается на стороне клиента.

Принцип работы:
1. **ProxyNode** подключается к **ProxyHub** и регистрируется в нём.
2. API-запросы, отправленные на **ProxyHub**, пересылаются на соответствующий **ProxyNode**.
3. **ProxyNode** перенаправляет запрос на целевой узел в сети клиента.
4. Ответ проходит в обратном направлении:  
   `узел клиента → ProxyNode → ProxyHub → клиент API`.

---

## Конфигурация ProxyNode

### Конфигурационный файл

При первом запуске ProxyNode (файл JAR) в рабочей директории создается файл конфигурации proxy_conf.txt со следующим содержанием:

```ini
# ProxyNode Configuration File

# Уникальный идентификатор ноды (генерируется автоматически)
node_id = 6207bdd6-10d4-4d1c-8dd2-5faesb6942e8

# Теги ноды для фильтрации (опционально, через запятую)
node_tags = 

# Адрес сервера Proxy Hub (без http/https)
server_url = 

# Порт сервера Proxy Hub (0 если не нужен)
server_port = 4448

# Использовать HTTPS/WSS (true/false)
https = true

# Адрес драйвера (рекомендуется localhost)
driver_url = 127.0.0.1

# Порт драйвера
driver_port = 9999
```

---

## Режимы работы

ProxyHub поддерживает два режима проксирования:
### 1. Режим подключения по ID (для отладки)

Прямое подключение к конкретной ноде без учёта её занятости.

Формат URL:
```
https://<server_url>:<server_port>/proxy/id/<node_id>
```

Пример: 
```
https://proxy.example.com:4448/proxy/id/6207bdd6-10d4-4d1c-8dd2-5faesb6942e8
```

### 2. Режим подключения по тегу

Запуск на случайной свободной ноде с указанным тегом.

Формат URL:
```
https://<server_url>:<server_port>/proxy/tag/<tag_name>
```

Пример:
```
https://proxy.example.com:4448/proxy/tag/chrome
```

---

## Установка и запуск

### Требования:

 - Java 17 или новее (JRE/JDK)

 - Доступ к серверу ProxyHub

 - Сетевой доступ к целевому узлу с машины, где запущен ProxyNode

### Инструкция по запуску:

1. Убедитесь, что установлена Java 17+
    ```
        java -version
    ```
2. Скачайте файл ProxyNode.jar

3. Поместите JAR-файл в отдельную директорию

4. При первом запуске автоматически создастся файл proxy_conf.txt

5. Отредактируйте файл proxy_conf.txt, указав параметры подключения

6. Запустите ProxyNode:
    ```
       java -jar ProxyNode.jar
    ```